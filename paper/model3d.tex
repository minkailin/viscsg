\section{Basic equations}\label{basic}
We consider a 3D, self-gravitating,
viscous disk with heating and cooling. We use the shearing box framework to
study a small patch of the disk \citep{goldreich65}. The local frame
co-rotates with a fiducial point in the unperturbed disk at angular
frequency $\Omega$. The Cartesian co-ordinates $(x,y,z)$ correspond
to the radial, azimuthal and vertical directions in the global disk. 
The fluid equations are
\begin{align}
  &\frac{\p\rho}{\p t} + \nabla\cdot\left(\rho\bm{v}\right) = 0, \\
  & \frac{\p\bm{v}}{\p t} + \bm{v}\cdot\nabla\bm{v} =
  -\frac{1}{\rho}\nabla P - \nabla\Phi - 2\Omega\hat{\bm{z}}\times\bm{v}\notag\\ & 
  \phantom{\frac{\p\bm{v}}{\p t} + \bm{v}\cdot\nabla\bm{v} =}
  +2\Omega^2qx\hat{\bm{x}} -\Omega_z^2z\hat{\bm{z}} 
   + \frac{1}{\rho}\nabla\cdot\bm{T},\label{momentum_eq}\\
  & \frac{\p E}{\p t} + \nabla\cdot\left(E\bm{v}\right) = - P
  \nabla\cdot\bm{v} + \mathcal{H}_\mathrm{visc} - \Lambda +
  \mathcal{H}_\mathrm{ext} ,\label{energy_eq}
\end{align} 
where $\rho$ is the density field and $\bm{v} = (v_x, v_y, v_z)$ is
the velocity field. 
We assume an ideal gas so that the pressure $P$ and thermal energy
density $E$ are related by  
\begin{align}
  P = (\gamma-1)E = \mathcal{R}\rho T, 
\end{align}
where $\mathcal{R}$ is the gas constant and $T$ is the temperature. The gas 
gravitational potential $\Phi$ is given via the Poisson equation,  
\begin{align}
 \nabla^2\Phi = 4 \pi G \rho. 
\end{align}


In the momentum equation (Eq. \ref{momentum_eq}), the third,
fourth/fifth, and last term on the right-hand side represent the Coriolis, 
tidal, and viscous forces (see below), respectively. We consider    
Keplerian disks with shear parameter $q=3/2$ and vertical oscillation 
frequency $\Omega_z=\Omega$.  

In the energy equation (Eq. \ref{energy_eq}) the source terms 
$\mathcal{H}_\mathrm{visc}$ and $\Lambda$
represent viscous heating and time-dependent cooling, 
respectively, and $\mathcal{H}_\mathrm{ext}$ represents any
time-independent heat source/sinks. We set
$\mathcal{H}_\mathrm{ext}=~0$ unless otherwise stated.  

\subsection{Viscosity and heating}\label{visc_model}
The Cartesian components of the viscous stress tensor $\bm{T}$ are
defined by 
\begin{align}
  T_{ij} \equiv \rho \left[\nu \left(\p_j v_i + \p_i v_j\right) +
    \left(\nu_b-\frac{2}{3}\nu\right)\delta_{ij}\nabla\cdot\bm{v}\right], 
\end{align}
%bulk visc ignored 
where $\rho\nu$ is the shear viscosity. We also include a bulk
viscosity $\rho\nu_b$ for completeness, but will neglect it in
numerical calculations. The associated viscous heating is given by 
\begin{align}
  \mathcal{H}_\mathrm{visc} \equiv \left(\p_jv_i\right)T_{ij}, 
\end{align}
where summation over repeated indices is implied. 

We adopt a viscosity law  
\begin{align}\label{visc_law}
  \nu = \alpha
  \frac{c_{s0}^2}{\Omega}\left(\frac{\rho}{\rho_\mathrm{eq}}\right)^\mu\left(\frac{P}{P_\mathrm{eq}}\right)^\lambda,             
\end{align}
where subscript `eq' denotes the equilibrium state and  
$c_{s0}^2\equiv P_\mathrm{eq}(z=0)/\rho_\mathrm{eq}(z=0)$. 
The dimensionless viscosity coefficient 
$\alpha=~\alpha(\rho_\mathrm{eq},P_\mathrm{eq})$ characterizes the
magnitude of the shear viscosity \emph{in steady state}. The indices
$\mu,\,\lambda$ are free parameters chosen to model how the viscosity
behaves in the perturbed state.  
We adopt the same prescription for the bulk viscosity but
with $\alpha\to\alpha_b$.   

Our numerical calculations use $\mu=-1,\lambda=0$ so 
that $\rho\nu$ is time-independent, following previous 
studies of viscous GI  
\citep{lynden-bell74,hunter83,willerding92,gammie96}.  
This choice eliminates viscous over-stability
\citep{schmit95,latter06}, which is unrelated to self-gravity, and
would otherwise contaminate our results. %obscure   

While steady-state viscosity values can be determined 
analytically or numerically \citep[e.g.][]{martin11,kratter08,rafikov15}, the time-dependent behavior is
not well-explored. We emphasize the choice $\mu=-1,\lambda=0$ is made
to bring out the physical process of interest --- viscous GI. 
Interestingly, though, \cite{laughlin96b} have suggested a $\nu \propto 1/\Sigma$
dependence when modeling the evolution of 2D self-gravitating disks 
as a viscous process. We note that if $\rho\nu$ is constant in time
then increasing the density corresponds to reduction in the viscosity. 
This is perhaps not inconsistent with numerical simulations of disk
fragmentation which show the internal flow of high-density clumps
appear laminar \citep{gammie01}. However, once clumps form they may
effectively decouple from the background disk state, and thus no 
longer be described by the same prescription. 
%we are not concerned with non-linear evolution    
%{\bf is this true? KMK: maybe caveat helps?}

\subsection{Steady states and cooling models}
We consider equilibrium solutions (here omitting the `eq' subscripts
for simplicity)  
\begin{align}
  \bm{v} &= -q\Omega x \hat{\bm{y}}, \\
  \rho   &= \rho(z),\\
  P      &= P(z) \equiv c_s^2(z)\rho.
\end{align} 
The equilibrium density and pressure fields are obtained by solving
the vertical momentum equation with self-gravity,
\begin{align}
  &\frac{1}{\rho}\frac{dP}{dz} +
  \Omega_z^2z + \frac{d\Phi}{dz} = 0, \label{vert_eq1}\\
 &\frac{d^2\Phi}{dz^2} = 4 \pi G \rho,\label{vert_eq2}
\end{align}
together with thermodynamic equilibrium,
\begin{align}\label{thermal_eq}
(q\Omega)^2\rho\nu + \mathcal{H}_\mathrm{ext} = \Lambda,
\end{align}
where the first term represents viscous heating. For the viscous
problem, $\nu\neq0$, and we set $\mathcal{H}_\mathrm{ext}=0$ to 
obtain a relation between viscous heating and cooling 
(e.g. Eq. \ref{alpha_beta_relation} below). However,
if we wish to neglect viscosity (and the accompanying dissipation) but include cooling, we must invoke
$\mathcal{H}_\mathrm{ext}\neq0$ to define an equilibrium state.  
To proceed further, we separately describe the two cooling models
considered in this work. 



\subsubsection{$\beta$ cooling}\label{beta_cool_model}
In our $\beta$ cooling model, the energy loss per unit volume is specified  
as an explicit function of the thermodynamic variables. 
A prototypical example is 
\begin{align}\label{beta_cool}
  \Lambda(\rho, T) =
  %  \frac{P}{(\gamma-1)T}\frac{\left(T-T_\mathrm{irr}\right)}{t_c}, 
  \frac{\mathcal{R}\rho}{(\gamma-1)}\frac{\left(T-T_\mathrm{irr}\right)}{t_c}. 
\end{align}
Recall  $\tcool = \beta\Omega^{-1}$ is 
the cooling timescale with $\beta$ a constant input parameter. Here, 
\begin{align}\label{tirr_def}
  \tirr = \theta T_\mathrm{eq}
\end{align}
is a reference temperature field parameterized as a constant 
fraction $\theta$ of the equilibrium temperature
$T_\mathrm{eq}$. Physically, $\tirr$ is the floor temperature set by,
for example, stellar or background irradiation. Note that $\theta$  
should only be interpreted as an irradiation parameter when it is 
defined through Eq. \ref{tirr_def} and 
Eq. \ref{beta_cool} adopted as the cooling function. 

For $\beta$-cooling given by Eq. \ref{beta_cool} we assume an 
equilibrium polytropic relation 
\begin{align} 
  P  =
%  \frac{c_{s0}^2\rho_0}{\Gamma}\left(\frac{\rho}{\rho_0}\right)^\Gamma,
  %  \equiv \frac{c_s^2(z)}{\Gamma}\rho,
c_{s0}^2\rho_0\left(\frac{\rho}{\rho_0}\right)^\Gamma,
\end{align}
where $\Gamma$ is the constant polytropic index and $\rho_0 =
\rho(z=0)$ is the equilibrium midplane density. 
The vertical structure is first obtained from 
Eq. \ref{vert_eq1}---\ref{vert_eq2}, %given strength of self-grav, via Q3d
then inserted into 
Eq. \ref{thermal_eq} to infer the required viscosity profile for
thermal equilibrium. If  $\mathcal{H}_\mathrm{ext}=0$, 
\begin{align}\label{alpha_beta_relation}
\alpha(z) = \frac{1}{(\gamma-1)\beta
   q^2}\frac{c_s^2(z)}{c_{s0}^2}\left(1 - \theta\right). 
%  \alpha(z) = \frac{1}{\Gamma(\gamma-1)\beta
%    q^2}\left(\frac{\rho}{\rho_0}\right)^{\Gamma-1} \left(1 - \theta\right). 
\end{align}

Beta cooling of the form Eq. \ref{beta_cool} is widely applied in 2D
and 3D numerical simulations of self-gravitating disks \citep{gammie01,
  rice05,rice11}. For this reason we will refer to it as the
`standard' beta cooling. It permits numerical experiments to be
carried out in a controlled manner as a function of the cooling time
$\beta$. An adiabatic disk corresponds to $\beta\to \infty$. The
physical meaning of the limit $\beta\to0$ depends on $\theta$, as
discussed in \S\ref{theta0}---\ref{theta1}.  

%We shall need to re-define $\theta$ and $\beta$  
%when considering other cooling functions (see below).    

We assume standard beta cooling in formulating the linear
problem. However, the corresponding linear problem for  
any other explicit cooling function, say $\Lambda_1(\rho,T)$, can be  
obtained by equating its linearized form to 
that of Eq. \ref{beta_cool}, i.e. setting $\delta \Lambda \equiv
\delta \Lambda_1$. This then defines the $\beta$ and $\theta$
parameters to be used in the framework we develop later (see also 
\S\ref{linear_bcool}). We do this in \S\ref{2dppd} where we adopt a  
more realistic beta cooling function for PPDs. In that case, $\theta$ 
may or may not directly represent a physical irradiation.     

\subsubsection{Radiative cooling}\label{rad_cool}
A more realistic treatment of cooling considers energy transfer by radiative diffusion. Then
\begin{align}
  \Lambda &= \nabla\cdot\bm{F}_\mathrm{rad},\label{rad_cool1}\\
  \bm{F}_\mathrm{rad}   &= -\frac{16\sigma T^3}{3\kappa_d\rho}\nabla T, \label{rad_cool2}
\end{align}
where $\sigma$ is the Stefan-Boltzmann constant and 
$\kappa_d$ is the (dust) opacity. We adopt
\begin{align}\label{opacity_law}
  \kappa_d = \kappa_{d0}T^b,
\end{align}
and take the constant index $b=2$ as appropriate for the cold outer regions
of a PPD with ISM-like dust grains \citep{bell94}, but retain the general notation $b$
to keep track of the opacity.    
%We use radiative cooling when considering 3D PPDs in \S.  

In this case, we specify a constant viscosity coefficient $\alpha$ and
solve Eq. \ref{vert_eq1}---\ref{thermal_eq}, together with
Eq. \ref{rad_cool1}---\ref{rad_cool2}, as a fourth order system of
ordinary differential equations to obtain equilibrium profiles $P(z)$, $T(z)$, and hence
$\rho(z)$.  

While radiative cooling is arguably more realistic than
$\beta$-cooling, it generally implies a vertically
non-isothermal equilibrium disk, and increases the order of the
linearized equations. It formally applies to optically-thick 
disks, but it is possible to modify the flux function to account
for optically-thin disks \citep{levermore81}. However, this
complication is beyond the scope of this work. 



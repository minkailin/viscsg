\section{Linear problem}\label{linear}
We consider infinitestimal axisymmetric Eulerian perturbations in the
form \begin{align}
  \delta \rho= \widetilde{\delta \rho}(z)\exp{\left(\ii kx +
    s t\right)},  
\end{align}
and similarly for other variables. Here, $k$  is an input real horizontal
wavenumber and $s$ is a (generally) complex growth rate.  
For simplicity, hereafter we drop the tilde.  


The linearized continuity, momentum and energy equations are
\begin{align}
   &s \delta \rho = - \ii k \rho\delta v_x -
  \left(\rho\delta v_z\right)^\prime \label{lin_mass} \\ 
   &s  \delta v_x = - \ii k\frac{\delta P}{\rho} - \ii k \delta 
  \Phi + 2\Omega \delta v_y + \delta F_x,\\
   &s \delta v_y = (q-2)\Omega\delta v_x + \delta F_y,\\
%   &s \delta v_z = - \left(\frac{\delta P}{\rho}\right)^\prime -
%  \delta\Phi^\prime +
%  \left(\ln{\rho}\right)^\prime\left(c_s^2\frac{\delta\rho}{\rho} -
%  \frac{\delta P}{\rho}\right) + \delta F_z,\\
  &s \delta v_z =
  \left(\ln{P}\right)^\prime c_s^2\frac{\delta\rho}{\rho} -
  \left(\frac{\delta P}{\rho}\right)^\prime -
  \left(\ln{\rho}\right)^\prime\frac{\delta P}{\rho} + \delta F_z, \\ 
  &s \frac{\delta P}{\rho} = 
%- \ii \gamma k \frac{c_s^2}{\Gamma}\delta v_x 
 - \ii k \gamma c_s^2\delta v_x
%- c_s^2\left[
%  \left(\ln{\rho}\right)^\prime\delta v_z + 
%  \frac{\gamma}{\Gamma}\delta v_z^\prime\right] \notag\\
- c_s^2\left[
 \left(\ln{P}\right)^\prime\delta v_z + 
  \gamma\delta v_z^\prime\right] \notag\\
   & \phantom{s \frac{\delta P}{\rho}=}
  + (\gamma-1)\frac{\delta\mathcal{H}_\mathrm{visc}}{\rho} 
  -(\gamma-1)\frac{\delta\Lambda}{\rho}
%  - \frac{1}{t_c}\left(\frac{\delta P}{\rho} -
%  \frac{\theta}{\Gamma}c_s^2\frac{\delta\rho}{\rho}\right) 
  \label{lin_energy},\\
  &\delta\Phi^{\prime\prime} - k^2\delta\Phi =
  \frac{\Omega^2}{Q_\mathrm{3D}}\left(\frac{\delta\rho}{\rho_0}\right)\label{lin_gravity},  
\end{align}
where $^\prime$ denotes $d/dz$. The perturbed viscous forces are 
\begin{align}
  \delta F_x =& \nu \left[\delta v_x^{\prime\prime} + 
    \left(\ln{\rho\nu}\right)^\prime \delta v_x^\prime - 
     \frac{4}{3}k^2\delta v_x \right] - \nu_bk^2\delta v_x \notag\\
   &+ \ii \nu k \left[\frac{1}{3}\delta v_z^\prime+ 
    \left(\ln{\rho\nu}\right)^\prime\delta v_z\right] + \ii k \nu_b
  \delta v_z^\prime,\\
  \delta F_y = & \nu  \left[\delta v_y^{\prime\prime} + 
    \left(\ln{\rho\nu}\right)^\prime \delta v_y^\prime - 
     k^2\delta v_y \right] - \ii\nu kq\Omega\delta\ln{\rho\nu},\\
  \delta F_z =& \nu\left[\frac{4}{3}\delta v_z^{\prime\prime} + 
    \frac{4}{3}\left(\ln{\rho\nu}\right)^\prime \delta v_z^\prime - 
    k^2\delta v_z \right] \notag\\
  & +\nu_b\left[\delta v_z^{\prime\prime} + \left(\ln{\rho\nu_b}\right)^\prime\delta v_z^\prime\right]\notag\\
  & + \ii \nu k  \left[\frac{1}{3}\delta v_x^\prime -  
    \frac{2}{3}\left(\ln{\rho\nu}\right)^\prime\delta v_x\right]\notag\\
  &+\ii \nu_b k \left[\delta v_x^\prime + \left(\ln{\rho\nu_b}\right)^\prime\delta v_x\right],
%  &\delta f_x = -\frac{4}{3} \nu k^2\Sigma \delta v_x,\\
%  &\delta f_y = -\ii q k \Omega \delta(\nu\Sigma) - \nu k^2
%  \Sigma\delta v_y,\\
%  &\delta Q_\mathrm{visc} = (q\Omega)^2\delta(\nu\Sigma) - 2 \ii \nu 
%  k q\Omega\Sigma\delta v_y,\\
%  &\delta(\nu\Sigma) =
%  \frac{\alpha}{\Omega}\left[c_s^2(1+\mu)\delta\Sigma + \lambda\delta P\right].
%  &\delta f_y = - \ii \nu q k \Omega \delta \Sigma - \nu k^2\Sigma\delta
%  v_y,\\
%  &\delta Q_\mathrm{visc} = \nu
%  \left(q\Omega\right)^2\delta\Sigma - 2\ii\nu q k \Omega\Sigma\delta
%  v_y. 
\end{align}
and the perturbed viscous heating is given by 
\begin{align}
  \frac{\delta\mathcal{H}_\mathrm{visc}}{\rho}=& \nu (q\Omega)^2
  \delta\ln{\rho\nu} - 2\ii\nu k q \Omega \delta v_y,\\
  \delta\ln{\rho\nu} =& (1+\mu)\frac{\delta\rho}{\rho} +
  \frac{\lambda}{c_s^2}\frac{\delta P}{\rho}. \label{linear_beta_cool}
\end{align}
In Eq. \ref{lin_gravity}, the 3D self-gravity parameter is
\begin{align}\label{Q3d_def}
  Q_\mathrm{3D} \equiv \frac{\Omega^2}{4\pi G \rho_0}. 
\end{align}
The linearized cooling functions $\delta\Lambda$ are given below. 
Eq. \ref{lin_mass}---\ref{lin_gravity}, supplemented with appropriate
boundary conditions, constitutes an eigenvalue problem for the growth
rate $s$. 

\subsection{Linearized beta cooling}
For the standard beta cooling prescription, linearizing
Eq. \ref{beta_cool} gives

\begin{align}
  (\gamma-1)\frac{\delta \Lambda}{\rho} = \frac{1}{t_c}\left(\frac{\delta P}{\rho} -
  \theta c_s^2 \frac{\delta\rho}{\rho}\right), \label{linear_beta}
\end{align}
where we have used $\delta T/T  = \delta P/P - \delta\rho/\rho$ from
the ideal gas law. 

\subsection{Linearized radiative cooling}
Linearizing Eq. \ref{rad_cool1}---\ref{rad_cool2} with the
temperature-dependent opacity law in Eq. \ref{opacity_law} gives
\begin{align}
  \frac{\delta \Lambda}{\rho} 
  =& \frac{16\sigma T^3}{3\kappa_d\rho^2} k^2 \delta T \notag\\
  & - \frac{16\sigma }{3\rho}\frac{d}{dz}\left\{
  \frac{T^3}{\kappa_d\rho}\left[\delta T^\prime +
    (3-b)\left(\ln{T}\right)^\prime \delta T - T^\prime \frac{\delta\rho}{\rho}\right]
  \right\}.\label{linear_rad_cool}
\end{align}
Since Eq. \ref{linear_rad_cool} contain vertical derivatives of the
perturbations, it is generally not possible to map radiative cooling 
to the beta cooling prescription, except for special problems
\citep[e.g.][]{lin15}. 

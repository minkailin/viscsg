\section{2D dispersion relation}\label{2ddisp}
The functions in Eq. \ref{thindisk} are 
\begin{align}
  A(S,K) =& \left(\frac{4}{3}\alpha+\alpha_b\right) K^2 + S +
  \mathcal{E}\mathcal{F}\label{bigA}
  - \frac{2|K|}{QS}, \\
  B(S,K) =& 2\left(\alpha q \mathcal{F} - 1\right),\\
  C(S,K) =& (2 - q) + \frac{\alpha q K^2(1+\mu)}{S} 
  + \alpha q \lambda \mathcal{E}\mathcal{F},\\
  D(S,K) = & \alpha K^2 + S + 2\alpha^2q^2\lambda\mathcal{F},
\end{align}
with
\begin{align}
  \mathcal{E} = \frac{\alpha q^2(1+\mu)}{S} +
    \frac{\gamma}{\gamma-1} + \frac{\theta}{\beta S(\gamma-1)},\quad
  \mathcal{F} = \frac{K^2(\gamma-1)\beta}{1 + \beta S - \alpha\beta
    q^2\lambda(\gamma-1)}\label{bigF}. 
\end{align}
Note that these equations treat $\alpha$ and $\beta$ as independent
parameters. 
%If beta cooling is entirely balanced by viscous heating in
%the background state, then the $\alpha$-$\beta$ relation,
%Eq. \ref{alpha_beta_relation}, should be applied.   

\section{2D viscous GI} \label{gammie_check}
We obtain the dispersion relation for viscous GI described by
previous authors \citep{lynden-bell74,willerding92,gammie96} as 
follows. We set $\mu=-1, \lambda=0$ to obtain the same viscosity
models. Next we consider $|\beta S|\to \infty$, i.e. no explicit
cooling on the perturbations. Then the condition $AD = BC$ imply 
\begin{align}
  S^3 + \left(\frac{7}{3}\alpha + \alpha_b\right)K^2S^2 + \left[2(2-q) -
    \frac{2|K|}{Q} + \gamma K^2 + \alpha K^4 \left(\frac{4}{3}\alpha +
    \alpha_b\right)\right]S + \alpha K^2 \left[\gamma K^2 -
    \frac{2|K|}{Q} - 2q(2-q)(\gamma-1)\right]=0,
\end{align}
which agrees with \citet[Eq. 11]{willerding92} in the isothermal
limit ($\gamma=1$). The non-isothermal term $\propto (\gamma-1)$
originates from viscous dissipation which was excluded in the
aforementioned works. Its effect is to increase the maximum wavenumber 
for viscous GI. %it acts to stabilize 

An approximate solution for the growth rate may be obtained for small
$|K|$ by balancing the last two terms,
\begin{align}
  S \simeq \frac{\alpha K^2\left[2|K|/Q- \gamma K^2 + 
     2q(2-q)(\gamma-1)\right]}{2(2-q)  - 2|K|/Q + \gamma K^2 }, 
\end{align}
which coincides with \citeauthor{gammie96}'s Eq. 18 for $\gamma=1$. 

%In
%that case the condition for instability is
%\begin{align}
%%  \frac{2|K|}{Q} - K^2>0. 
%  |K|< \frac{2}{Q}.
%\end{align} 
%This is the same stability condition as if rotation was neglected in
%the standard, isothermal dispersion relation for density waves
%(obtained from Eq. \ref{thindisk} by setting $\gamma=\theta=1$). Thus
%the effect of viscosity is to remove 
%rotational stabilization against self-gravity, as originally explained
%by \cite{lynden-bell74}.  

%We recover \cite{gammie96}'s dispersion relation 
%for viscous gravitational instability as follows.  Next we
%simplify Eq. \ref{bigA}---\ref{bigF} by assuming $|\beta S |\gg 1$  
%This will turn out to be equivalent to $\beta\gg 1$, i.e. the
%adiabatic limit. 
%and $S\lesssim O(K^2)$ as $|K|\to 0$. Applying these considerations to
%Eq. \ref{thindisk} gives 
%\begin{align}
%  S = \frac{\alpha K^2\left[\frac{2|K|}{Q} - \gamma K^2 +
%      2q(2-q)(\gamma-1)\right]}{2(2-q) + \gamma K^2 - \frac{2K}{Q}}, 
%\end{align}
%which does not explicitly depend on cooling. 
%Setting $\gamma=1$ then gives \citeauthor{gammie96}'s Eq. 18. The above
%is expression thus generalizes \citeauthor{gammie96}'s result to
%non-isothermal disks. 

%cooling is not the physical cause of instability 

\section{3D corrections in 2D theory}\label{3dcorr}
The simplest way to mimic the effect of finite disk thickness
on gravitational instabilities is to weaken self-gravity by reducing 
the gravitational constant  
\begin{align}
  G \to G\left(1+|k|H_\mathrm{sg}\right)^{-1}, 
\end{align}
or equivalently $Q\to Q\left(1+|k|H_\mathrm{sg}\right)$. This
prescription, derived by \cite{shu84}, is widely applied
\citep[e.g.][]{youdin11,takahashi14}. Here $H_\mathrm{sg}$ is a
measure of the disk thickness. We intuitively expect
$H_\mathrm{sg}\sim H$, but its precise value is not known a priori.   
We regard $H_\mathrm{sg}$ as a free parameter of the problem.    


\section{Numerical method for the 3D eigenvalue problem}\label{3d_method}
We use a pseudo-spectral method to solve the set of ordinary
differential equations, Eq. \ref{lin_mass}---\ref{lin_gravity}, on 
the domain $ z\in[0,\zmax]$ with a parity condition at the midplane.
We expand $\bm{U}=[\delta P,\delta\rho,\delta\Phi,
  \delta v_x, \delta 
  v_y]$ in even Chebyshev polynomials,
\begin{align}
  \bm{U}(z) = \sum_{j=1}^N \bm{a}_jT_{2(j-1)}(z/\zmax), 
\end{align}
and the vertical velocity in odd Chebyshev polynomials,
\begin{align}
  \delta v_z(z) = \sum_{j=1}^N b_jT_{2j-1}(z/\zmax),   
\end{align}
where $\bm{a}_j$ and $b_j$ are the spectral coefficients. 
The basis functions are chosen to satisfy a reflecting boundary
condition at the midplane, %GI has even symmetry across midplane 
\begin{align}
  \bm{U}^\prime(0) = \bm{0}, \quad \delta v_z(0) = 0.
\end{align}
%At the upper disk boundary we also apply reflection,
For simplicity we apply a reflecting upper disk boundary, %free
                                %boundary give similar results
\begin{align}
  \delta v_z(\zmax) = \delta v_x^\prime(\zmax) = \delta
  v_y^\prime(\zmax) = 0,
\end{align}
and the potential satisfies
\begin{align}
  \delta \Phi^\prime (\zmax) + k \delta\Phi(\zmax) = 0, 
\end{align}
as derived by \cite{goldreich65a} and used in similar studies  
\citep{kim12,lin14c}. %reflection is standard in direct simulations 

We discretize the equations, including upper disk boundary conditions,
over the $N$ positive abscissae of the extrema of $T_{2N-1}$. This
procedure converts the differential equations into a generalized
eigenvalue problem, for which we use the standard matrix package
LAPACK to solve. We use $N=65$. 
